# 景艺大自动校园网登录与登出脚本

该项目包含两个脚本，用于校园网的自动登录与登出操作，并支持可选的系统关机功能。脚本支持定时运行、异常处理，并可打包为可执行文件（EXE）以方便在 Windows 环境下使用。

---

## 功能介绍

### 登录脚本
- **自动检测 Wi-Fi 名称**：判断是否连接到指定的 Wi-Fi 网络。
- **自动登录校园网**：支持动态参数生成与本地 IP 地址获取。
- **系统通知**：登录成功后发送 Windows 系统通知。
- **错误日志**：捕获并记录错误，方便调试。

### 登出脚本
- **自动登出校园网**：支持动态参数生成与本地 IP 地址获取。
- **关机提示**：登出后弹出对话框，询问用户是否需要立即关机。
- **关机功能**：支持 Windows 系统的彻底关机操作。

---

## 环境配置

### 依赖环境
- **Python**：Python 3.6 或更高版本
- **依赖库**：
  - `requests`（需安装）
  - `ctypes`、`subprocess`、`socket`（Python 内置库）

## 使用说明

### 登录脚本

1. **修改登录参数**：
   - 打开 `login_script.py` 脚本。
   - 替换以下内容为你的实际校园网账号信息：
     - `user_account`：替换为你的校园网账号（例如：`学号@运营商`）。
     - `user_password`：替换为你的校园网密码。
   - 替换 Wi-Fi 名称：
     - 将脚本中 `Jvua` 替换为你的校园 Wi-Fi 名称。

2. **运行登录脚本**：
   - 使用以下命令运行脚本：
     ```bash
     python login_script.py
     ```

3. **运行结果**：
   - 如果已连接到指定 Wi-Fi 且登录成功：
     - 控制台会显示“登录成功！”。
     - 会弹出系统通知，提示“校园网登录成功”。
   - 如果连接 Wi-Fi 或登录失败：
     - 控制台会显示错误信息。
     - 检查 `error_log.txt` 了解具体错误原因。

---

### 登出脚本

1. **修改登出参数**：
   - 打开 `logout_script.py` 脚本。
   - 替换以下内容为你的实际校园网账号信息：
     - `user_account`：替换为你的校园网账号（例如：`drcom` 或其他登出账号）。
     - `user_password`：替换为你的校园网密码。

2. **运行登出脚本**：
   - 使用以下命令运行脚本：
     ```bash
     python logout_script.py
     ```

3. **运行结果**：
   - 如果登出成功：
     - 控制台会显示“登出成功！”。
     - 系统会弹出一个对话框，询问是否需要关机。
   - 如果选择关机：
     - 系统将执行彻底关机操作。
   - 如果登出失败：
     - 控制台会显示错误信息，检查并调整参数后重试。

---

### 定时运行脚本

#### 方法 1：直接使用命令
- 使用 `Task Scheduler` 调用脚本文件，设置为定时运行。
- 具体设置方法参考“[设置定时启动](#设置定时启动)”章节。

#### 方法 2：使用 `.exe` 打包运行
1. 打包脚本为可执行文件（参考“[打包成 EXE 可执行文件](#打包成-exe-可执行文件)”）。
2. 设置任务计划程序直接调用 `.exe` 文件。

---

## iOS 版快捷方式

- [登录校园网](https://www.icloud.com/shortcuts/988ff511b2064655b9296f571b0a8660)
- [登出校园网](https://www.icloud.com/shortcuts/de2a21fb559843d199c43ac304bafa45)

点击相应链接即可跳转并添加到您的 iOS 设备上。
